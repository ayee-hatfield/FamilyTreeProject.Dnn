[JavaScript:{ jsname: "jQuery" }]
[JavaScript:{ jsname: "jQuery-UI" }]
[JavaScript:{ jsname: "Knockout" }]
[JavaScript:{ path: "~/DesktopModules/Ftp/FamilyTreeProject/ClientScripts/knockout-jqueryui/knockout-jqueryui.min.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/dnn.extensions.js"}]
[JavaScript:{ path: "~/Resources/Shared/components/DropDownList/dnn.DropDownList.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/dnn.jquery.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/dnn.jquery.extensions.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/jquery/dnn.jScrollbar.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/dnn.DataStructures.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/dnn.WebResourceUrl.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/jquery/jquery.iframe-transport.js"}]
[JavaScript:{ path: "~/Resources/Shared/scripts/jquery/jquery.fileupload.js"}]
[JavaScript:{ path: "~/Resources/Shared/components/FileUpload/dnn.FileUpload.js"}]
[JavaScript:{ path: "~/DesktopModules/Ftp/FamilyTreeProject/ClientScripts/curl/curl.js"}]
[Css:{ path: "//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"}]
[Css:{ path: "~/Resources/Shared/components/FileUpload/dnn.FileUpload.css"}]


<div id="FTP-[ModuleContext:ModuleId]" class="ftpContainer">
    <div class="ftpHeading">
        <div>[Resx:{key:"Heading"}]</div>
        <!-- ko component: {
                name: "treeSelector",
                params: { treeId : treeId }
            } -->
        <!-- /ko -->
        <div>
            <a class="ftpIcon"><i class="fa fa-home"></i></a>
        </div>
    </div>
    <div id="ftpGettingStarted" data-bind="visible: treeId() == -1" style="display:none">
        <div>
            <div class="dnnFormInfo dnnFormMessage">[Resx:{key:"GettingStartedMessage"}]</div>
        </div>
    </div>
    <div class="ftpBody" data-bind="visible: treeId() > 0" style="display:none">
        <!-- ko component: {
                name: "viewSelector",
                params: { panels : panels, activePanel : activePanel }
            } -->
        <!-- /ko -->

        <div id="ftp-panels">
            <!-- ko if: activePanel() == "tree" -->
                <!-- ko component: {
                        name: "treeView",
                        params: { treeId: treeId }
                    } -->
                <!-- /ko -->
            <!-- /ko -->
            <!-- ko if: activePanel() == "individuals" -->
                <!-- ko component: {
                        name: "individualList",
                        params: { treeId: treeId }
                    } -->
                <!-- /ko -->
            <!-- /ko -->
            <!-- ko if: activePanel() == "familyGroup" -->
                <!-- ko component: {
                        name: "familyGroupView",
                        params: { }
                    } -->
                <!-- /ko -->
            <!-- /ko -->
            <!-- ko if: activePanel() == "ancestors" -->
                <!-- ko component: {
                        name: "ancestorsView",
                        params: { }
                    } -->
                <!-- /ko -->
            <!-- /ko -->


        </div>

        <div id="loadingbar" style="display: none;">
            <div></div>
        </div>
    </div>
</div>

<script language="javascript" type="text/javascript">

    (function () {
        var moduleId = parseInt("[ModuleContext:ModuleId]");

        var localizedSettings = {
            addIndividual: '[Resx:{key:"AddIndividual"}]',
            ancestorView: '[Resx:{key:"AncestorView"}]',
            birth: '[Resx:{key:"Birth"}]',
            cancel: '[Resx:{key:"Cancel"}]',
            createTree: '[Resx:{key:"CreateTree"}]',
            createTreeMessage: '[Resx:{key:"CreateTreeMessage"}]',
            death: '[Resx:{key:"Death"}]',
            description: '[Resx:{key:"Description"}]',
            families: '[Resx:{key:"Families"}]',
            familyGroupView: '[Resx:{key:"FamilyGroupView"}]',
            fileUpload: {
                title:'[Resx:{key:"UploadFile"}]',
                uploadToFolderLabel:'[Resx:{key:"UploadTo"}]',
                dragAndDropAreaTitle: '[Resx:{key:"DragAndDropAreaTitle"}]',
                uploadFileMethod: '[Resx:{key:"UploadFileMethod"}]',
                uploadFromWebMethod: '[Resx:{key:"UploadFromWebMethod"}]',
                closeButtonText: '[Resx:{key:"CloseButtonText"}]',
                uploadFromWebButtonText: '[Resx:{key:"UploadFromWebButtonText"}]',
                fileIsTooLarge: '[Resx:{key:"FileIsTooLarge"}]',
                fileUploadCancelled: '[Resx:{key:"FileUploadCancelled"}]',
                fileUploadFailed: '[Resx:{key:"FileUploadFailed"}]',
                fileUploaded: '[Resx:{key:"FileUploaded"}]',
                emptyFileUpload: '[Resx:{key:"EmptyFileUpload"}]',
                fileAlreadyExists: '[Resx:{key:"FileAlreadyExists"}]',
                uploadStopped: '[Resx:{key:"UploadStopped"}]',
                urlTooltip: '[Resx:{key:"UrlTooltip"}]',
                keepButtonText: '[Resx:{key:"KeepButtonText"}]',
                replaceButtonText: '[Resx:{key:"ReplaceButtonText"}]',
                tooManyFiles: '[Resx:{key:"TooManyFiles"}]',
                errorDialogTitle: '[Resx:{key:"ErrorDialogTitle"}]'
            },
            findIndividual: '[Resx:{key:"FindIndividual"}]',
            homePerson: '[Resx:{key:"HomePerson"}]',
            individualList: '[Resx:{key:"IndividualList"}]',
            individuals: '[Resx:{key:"Individuals"}]',
            individuals_NoPagerFormat: '[Resx:{key:"Individuals_NoPagerFormat"}]',
            individuals_PagerFormat: '[Resx:{key:"Individuals_PagerFormat"}]',
            individualsPageSize: '[Resx:{key:"IndividualsPageSize"}]',
            lastViewed: '[Resx:{key:"LastViewed"}]',
            myFolder: '[Resx:{key:"MyFolder"}]',
            name: '[Resx:{key:"Name"}]',
            pager_PageDesc: '[Resx:{key:"Pager_PageDesc"}]',
            save: '[Resx:{key:"Save"}]',
            summary: '[Resx:{key:"Summary"}]',
            title: '[Resx:{key:"Title"}]',
            tree: '[Resx:{key:"Tree"}]',
            treeOverView: '[Resx:{key:"TreeOverView"}]',
            uploadTree: '[Resx:{key:"UploadTree"}]',
            uploadTreeMessage: '[Resx:{key:"UploadTreeMessage"}]'
        };

        var settings = {
            moduleId: moduleId,

            initialPanel: "tree",
            ancestorsPanel: "ancestors",
            individualsPanel: "individuals",
            familyGroupPanel: "familyGroup",
            treePanel: "tree"
        };

        var sfSettings = {
            servicesFramework: $.ServicesFramework(moduleId),
            loadingBarId: '#loadingbar',
            servicePath: "FTP/FamilyTreeProject"
        }

        //Configure AMD Loader
        curl.config({
            baseUrl: "DesktopModules/FTP/FamilyTreeProject/ClientScripts",
            apiName: "require",
            paths: {
                "jquery": "modules/jquery.js",
                "knockout": "modules/knockout.js",
                "dnnUtility": "/Resources/Shared/Scripts/dnn.utility.js",
                "dnnPager": "/Resources/Shared/Scripts/dnn.kopager.js",
                "config": "modules/config.js"
            }
        });

        //Load Configuration
        require(["config", "js!dnnUtility", "domReady!"], function (cfg) {
            cfg.init(settings, localizedSettings, sfSettings);
        });

        //Bootstrap Application
        require(["familyTreeProject", "domReady!"], function (ftp) {
            ftp.init();
        });
    }());

</script>
